<!DOCTYPE html> <html lang="en"> <head>     <meta charset="UTF-8">     <meta name="viewport" content="width=device-width, initial-scale=1.0">     <title>Nested JSON Viewer</title>     <!-- Tailwind CSS for styling -->     <script src="https://cdn.tailwindcss.com"></script>     <link rel="stylesheet" href="https://rsms.me/inter/inter.css">     <!-- Prism CSS for syntax highlighting (for objects/arrays) -->     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">     <!-- KaTeX CSS for math rendering -->     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">      <style>         /* Custom styles for a modern, dark theme */         body {             font-family: 'Inter', sans-serif;             background-color: #111827; /* gray-900 */             color: #d1d5db; /* gray-300 */         }         /* Custom scrollbar for a better look */         ::-webkit-scrollbar {             width: 8px;         }         ::-webkit-scrollbar-track {             background: #1f2937; /* gray-800 */         }         ::-webkit-scrollbar-thumb {             background: #4b5563; /* gray-600 */             border-radius: 4px;         }         ::-webkit-scrollbar-thumb:hover {             background: #6b7280; /* gray-500 */         }         /* Styles for the nested sidebar list */         .sidebar-item {             cursor: pointer;             padding: 6px 8px;             border-radius: 4px;             transition: background-color 0.2s ease-in-out;         }         .sidebar-item:hover {             background-color: #374151; /* gray-700 */         }         .sidebar-item.active {             background-color: #4f46e5; /* indigo-600 */             color: #ffffff; /* white */         }         .sidebar-item .key-name {             display: inline-block;             vertical-align: middle;         }         .sidebar-item .toggle-icon {             display: inline-block;             width: 1em;             text-align: center;             margin-right: 4px;             transition: transform 0.2s;             vertical-align: middle;         }         .nested-list {             display: none; /* Hidden by default */             margin-left: 1rem;             border-left: 1px solid #4b5563; /* gray-600 */         }         .nested-list.open {             display: block; /* Shown when toggled */         }         .sidebar-item.expanded > .toggle-icon {             transform: rotate(90deg);         }         /* Styles for rendered Markdown content */         #json-content-area .markdown-content {             color: #d1d5db;         }         #json-content-area .markdown-content h1,          #json-content-area .markdown-content h2,          #json-content-area .markdown-content h3 {             color: #ffffff;             border-bottom: 1px solid #4b5563;             padding-bottom: 0.3em;             margin-top: 1.5em;             margin-bottom: 1em;         }         #json-content-area .markdown-content p {             line-height: 1.7;             margin-bottom: 1em;         }         #json-content-area .markdown-content code {             background-color: #2d3748; /* gray-800 adjusted */             padding: 0.2em 0.4em;             border-radius: 3px;             font-family: monospace;             color: #a7f3d0; /* emerald-200 */         }         #json-content-area .markdown-content pre code {             display: block;             padding: 1em;         }         #json-content-area .markdown-content blockquote {             border-left: 4px solid #4f46e5; /* indigo-600 */             padding-left: 1em;             color: #9ca3af; /* gray-400 */             margin-left: 0;             font-style: italic;         }         #json-content-area .markdown-content ul,          #json-content-area .markdown-content ol {             padding-left: 1.5em;             margin-bottom: 1em;         }         #json-content-area .markdown-content li {             margin-bottom: 0.5em;         }         #json-content-area .markdown-content a {             color: #818cf8; /* indigo-400 */             text-decoration: underline;         }         /* Tab styles */         .tab-button {             padding: 0.5rem 1rem;             cursor: pointer;             border: none;             background-color: transparent;             color: #9ca3af; /* gray-400 */             border-bottom: 2px solid transparent;             transition: all 0.2s ease-in-out;         }         .tab-button.active {             color: #ffffff; /* white */             border-bottom-color: #4f46e5; /* indigo-600 */         }         .tab-content {             display: none;         }         .tab-content.active {             display: block;         }         #mind-map-area svg {             width: 100%;             height: 100%;             display: block;         }     </style> </head> <body class="h-screen antialiased">     <div class="flex flex-col h-full">         <!-- Header Section -->         <header class="bg-gray-800 border-b border-gray-700 p-4 shadow-md">             <h1 class="text-2xl font-bold text-white">Nested JSON File Viewer</h1>             <p class="text-gray-400">Upload a JSON file to browse its nested structure.</p>             <!-- File Input -->             <div class="mt-4">                 <label for="file-upload" class="cursor-pointer inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-200">                     <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />                     </svg>                     <span>Upload JSON File</span>                 </label>                 <input id="file-upload" type="file" class="hidden" accept=".json">                 <span id="file-name" class="ml-4 text-gray-400">No file selected.</span>             </div>         </header>          <!-- Main Content Area -->         <div class="flex flex-grow overflow-hidden">             <!-- Side Panel for JSON keys -->             <aside id="side-panel" class="w-1/3 md:w-1/4 h-full bg-gray-800 border-r border-gray-700 overflow-y-auto">                 <h2 class="text-lg font-semibold p-4 border-b border-gray-700 text-white sticky top-0 bg-gray-800">Parameters</h2>                 <div id="json-keys-list" class="p-2">                      <p class="px-2 py-2 text-gray-500">Please upload a JSON file to see its parameters.</p>                 </div>             </aside>              <!-- Content Display for selected key's value -->             <main id="content-display" class="w-2/3 md:w-3/4 h-full p-6 flex flex-col overflow-y-auto">                 <!-- Tab Navigation -->                 <div class="border-b border-gray-700 mb-4">                     <button id="content-tab-button" class="tab-button active">Content</button>                     <button id="mindmap-tab-button" class="tab-button">Mind Map</button>                 </div>                  <!-- Tab Content -->                 <div id="content-tab-content" class="tab-content active flex-grow">                     <div id="json-content-area" class="bg-gray-900 p-6 rounded-lg border border-gray-700 min-h-[100px]">                          <p class="text-gray-500">Select a parameter from the side panel to view its content here.</p>                     </div>                 </div>                  <div id="mindmap-tab-content" class="tab-content flex-grow">                     <div id="mind-map-area" class="bg-gray-900 rounded-lg border border-gray-700 h-full w-full">                         <p class="p-6 text-gray-500">Please upload a JSON file to generate a mind map.</p>                     </div>                 </div>             </main>         </div>     </div>      <!-- JS Libraries -->     <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>     <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script> 	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>     <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>     <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>     <!-- Explicitly add D3.js, which is a core dependency for Markmap -->     <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>     <script src="https://cdn.jsdelivr.net/npm/markmap-view@0.15.5/dist/browser/index.min.js"></script>      <script>         window.onload = () => {             // DOM element references             const fileUpload = document.getElementById('file-upload');             const fileNameSpan = document.getElementById('file-name');             const jsonKeysList = document.getElementById('json-keys-list');             const jsonContentArea = document.getElementById('json-content-area');             const mindMapArea = document.getElementById('mind-map-area');              // Tab elements             const contentTabButton = document.getElementById('content-tab-button');             const mindMapTabButton = document.getElementById('mindmap-tab-button');             const contentTabContent = document.getElementById('content-tab-content');             const mindMapTabContent = document.getElementById('mindmap-tab-content');              let jsonData = null; // Variable to store the parsed JSON data             let markmapInstance = null; // To hold the mind map instance              // Event listener for file input change             fileUpload.addEventListener('change', handleFileSelect);              // Event listeners for tabs             contentTabButton.addEventListener('click', () => switchTab('content'));             mindMapTabButton.addEventListener('click', () => switchTab('mindmap'));              /**              * Switches the active tab in the main content area.              * @param {string} tabName - The name of the tab to switch to ('content' or 'mindmap').              */             function switchTab(tabName) {                 if (tabName === 'content') {                     contentTabButton.classList.add('active');                     mindMapTabButton.classList.remove('active');                     contentTabContent.classList.add('active');                     mindMapTabContent.classList.remove('active');                 } else {                     contentTabButton.classList.remove('active');                     mindMapTabButton.classList.add('active');                     contentTabContent.classList.remove('active');                     mindMapTabContent.classList.add('active');                     if (markmapInstance) markmapInstance.fit(); // Refit map when tab is shown                 }             }              /**              * Handles the file selection, reading, and parsing.              */             function handleFileSelect(event) {                 const file = event.target.files[0];                 if (!file) {                     fileNameSpan.textContent = 'No file selected.';                     resetUI();                     return;                 }                 fileNameSpan.textContent = `Selected: ${file.name}`;                 const reader = new FileReader();                 reader.onload = function(e) {                     try {                         jsonData = JSON.parse(e.target.result);                         populateSidePanel(jsonData);                         renderMindMap(jsonData);                     } catch (error) {                         console.error('Error parsing JSON:', error);                         resetUI();                         const errorMessage = `<strong>Error: Could not parse the file.</strong><br>Please ensure it is a valid JSON file.<br><br><span class="text-sm text-gray-400">Details: ${error.message}</span>`;                         jsonContentArea.innerHTML = `<div class="text-red-400 p-4 rounded-md bg-red-900/20 border border-red-500/30">${errorMessage}</div>`;                     }                 };                 reader.onerror = function() {                     console.error('Error reading file:', reader.error);                     resetUI();                     const errorMessage = `<strong>Error: Could not read the file.</strong><br>This might be due to file permissions or if the file is corrupted.`;                     jsonContentArea.innerHTML = `<div class="text-red-400 p-4 rounded-md bg-red-900/20 border border-red-500/30">${errorMessage}</div>`;                 };                 reader.readAsText(file);             }                          function populateSidePanel(data) {                 jsonKeysList.innerHTML = '';                 if (Object.keys(data).length === 0) {                      jsonKeysList.innerHTML = `<p class="px-2 py-2 text-gray-500">JSON file is empty.</p>`;                      return;                 }                 const rootList = createNestedList(data, []);                 jsonKeysList.appendChild(rootList);                 jsonContentArea.innerHTML = `<p class="text-gray-500">Select a parameter from the side panel to view its content here.</p>`;             }              function createNestedList(data, path) {                 const ul = document.createElement('ul');                 if (path.length > 0) ul.className = 'nested-list';                  Object.keys(data).forEach(key => {                     const currentPath = [...path, key];                     const value = data[key];                     const isObject = typeof value === 'object' && value !== null;                      const li = document.createElement('li');                     li.className = 'sidebar-item';                     li.dataset.path = JSON.stringify(currentPath);                      let contentHTML = isObject ? '<span class="toggle-icon">►</span>' : '<span class="toggle-icon"> </span>';                     contentHTML += `<span class="key-name">${key}</span>`;                     li.innerHTML = contentHTML;                      li.addEventListener('click', (e) => {                         e.stopPropagation();                          document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));                         li.classList.add('active');                         displayContent(currentPath);                         if (isObject) {                             li.classList.toggle('expanded');                             const nestedUl = li.querySelector('.nested-list');                             if (nestedUl) nestedUl.classList.toggle('open');                         }                     });                      if (isObject) {                         const nestedUl = createNestedList(value, currentPath);                         li.appendChild(nestedUl);                     }                     ul.appendChild(li);                 });                 return ul;             }              function displayContent(path) {                 switchTab('content'); // Switch to content tab when a key is clicked                 const value = path.reduce((obj, key) => (obj && obj[key] !== 'undefined') ? obj[key] : undefined, jsonData);                 jsonContentArea.innerHTML = '';                  if (typeof value === 'string') {                     const markdownContainer = document.createElement('div');                     markdownContainer.className = 'markdown-content';                     markdownContainer.innerHTML = marked.parse(value);                     jsonContentArea.appendChild(markdownContainer);                     renderMathInElement(markdownContainer, { delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}] });                 } else if (typeof value === 'object' && value !== null) {                     const pre = document.createElement('pre');                     pre.className = 'text-base';                     const code = document.createElement('code');                     code.className = 'language-json';                     code.textContent = JSON.stringify(value, null, 2);                     pre.appendChild(code);                     jsonContentArea.appendChild(pre);                     Prism.highlightElement(code);                 } else {                     const pre = document.createElement('pre');                     pre.textContent = String(value);                     jsonContentArea.appendChild(pre);                 }             }              /**              * Transforms JSON data into a node structure for Markmap.              * @param {*} data - The data to transform (object, array, or primitive).              * @param {string} name - The name of the node.              * @returns {object} A Markmap-compatible node.              */             function transformJsonToMarkmap(data, name = 'root') {                 const isObject = typeof data === 'object' && data !== null && !Array.isArray(data);                 const isArray = Array.isArray(data);                  if (isObject) {                     const children = Object.keys(data).map(key => transformJsonToMarkmap(data[key], key));                     return { content: name, children: children.length > 0 ? children : undefined };                 } else if (isArray) {                     const children = data.map((item, index) => transformJsonToMarkmap(item, `[${index}]`));                     return { content: name, children: children.length > 0 ? children : undefined };                 } else {                     // For primitive values, show them directly                     return { content: `${name}: ${JSON.stringify(data)}` };                 }             }              /**              * Renders the mind map visualization from the JSON data.              * @param {object} data - The parsed JSON data.              */             function renderMindMap(data) {                 if (markmapInstance) {                     markmapInstance.destroy();                 }                 mindMapArea.innerHTML = ''; // Clear previous map content                 const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');                 mindMapArea.appendChild(svg);                                  const rootNode = transformJsonToMarkmap(data, 'JSON');                                  // More robust way to call Markmap that aligns with its documentation                 if (window.markmap) {                     const { Markmap } = window.markmap;                     // Ensure the Markmap class and its create method are available                     if (Markmap && typeof Markmap.create === 'function') {                         markmapInstance = Markmap.create(svg, null, rootNode);                     } else {                         console.error('Markmap library loaded, but Markmap class is missing or invalid.');                         mindMapArea.innerHTML = '<p class="p-6 text-red-400">Error: The mind map library loaded, but failed to initialize properly. Please try reloading.</p>';                     }                 } else {                     console.error('Markmap library not loaded correctly.');                     mindMapArea.innerHTML = '<p class="p-6 text-red-400">Error: Could not render the mind map because a required library did not load.</p>';                 }             }                          function resetUI() {                 jsonData = null;                 if (markmapInstance) {                     markmapInstance.destroy();                     markmapInstance = null;                 }                 jsonKeysList.innerHTML = `<p class="px-2 py-2 text-gray-500">Please upload a JSON file.</p>`;                 jsonContentArea.innerHTML = `<p class="text-gray-500">Select a parameter to view its content.</p>`;                 mindMapArea.innerHTML = `<p class="p-6 text-gray-500">Please upload a JSON file to generate a mind map.</p>`;                 switchTab('content');             }         };     </script> </body> </html>    
